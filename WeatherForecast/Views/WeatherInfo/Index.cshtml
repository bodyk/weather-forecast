
@model WeatherForecast.Models.WeatherInfo

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Index";

    string cityName = @Model?.weatherInfo?.city?.name ?? "";
    string countryCode = @Model?.weatherInfo?.city?.country ?? "";
}

<script>
    function timeConverter(unixTimestamp) {
        var a = new Date(unixTimestamp * 1000);
        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        var year = a.getFullYear();
        var month = months[a.getMonth()];
        var date = a.getDate();
        var hour = a.getHours();
        var min = a.getMinutes();
        var sec = a.getSeconds();
        var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec;
        return time;
    }
</script>

<div id="apiDiv">
    <h4>Select the City for Weather Report</h4>
    <div>
        @Html.ActionLink("Kiev", "Index", new { city = "Kiev" })<br />
        @Html.ActionLink("Lviv", "Index", new { city = "Lviv" })<br />
        @Html.ActionLink("Kharkiv", "Index", new { city = "Kharkiv" })<br />
        @Html.ActionLink("Dnipropetrovsk", "Index", new { city = "Dnipropetrovsk" })<br />
        @Html.ActionLink("Odessa", "Index", new { city = "Odessa" })<br />
    </div>

    @using (Html.BeginForm("Index", "WeatherInfo"))
    {
        <div>
            @Html.TextBox("city", null)
        </div>
        <input type="submit" value="Submit" />
    }

    @if (@Model?.weatherInfo?.cnt != 0)
    {
        <div>
            @Html.ActionLink("Current Day", "Index", new { time = 1, city = @Model?.weatherInfo?.city?.name })<br />
            @Html.ActionLink("3 Days", "Index", new { time = 3, city = @Model?.weatherInfo?.city?.name })<br />
            @Html.ActionLink("7 Days", "Index", new { time = 7, city = @Model?.weatherInfo?.city?.name })<br />
        </div>
        <table>
            <tr>
                <th>Weather Description</th>
            </tr>
            <tr>
                <td>City:</td>
                <td>@cityName</td>
            </tr>
            <tr>
                <td>Country code:</td>
                <td>@countryCode</td>
            </tr>
            <tr>
                @foreach (var info in @Model.weatherInfo.list)
                {
                    <tr>
                        <td><hr/></td>
                    </tr>
                    <tr>
                        <td>Dt:</td>
                        <td>
                            <script> document.write(timeConverter(@info.dt)) </script>
                        </td>
                    </tr>
                    <tr>
                        <td>Temperature:</td>
                        <td>@info.temp.day</td>
                    </tr>
                    <tr>
                        <td>Humidity:</td>
                        <td>@info.humidity</td>
                    </tr>
                    <tr>
                        <td>Pressure:</td>
                        <td>@info.pressure</td>
                    </tr>
                    <tr>
                        <td>Wind Speed:</td>
                        <td>@info.speed</td>
                    </tr>
                    <tr>
                        <td>Clouds:</td>
                        <td>@info.clouds</td>
                    </tr>
                }

            </table>
    }

</div>
